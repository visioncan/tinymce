tinymce.PluginManager.add("advtextcolor",function(a,b){function d(){var b,d,c=[];for(d=a.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Brown","C0C0C0","Silver","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum","FFFFFF","White"],b=0;b<d.length;b+=2)c.push({text:d[b+1],color:d[b]});return c}function e(){window.localStorage&&window.localStorage.getItem("color")&&(c=JSON.parse(window.localStorage.color))}function f(a){var b=[];c.push(a.replace("#","")),b=c.length>16?c.slice(-16):c,window.localStorage&&(window.localStorage.color=JSON.stringify(b))}function g(){var f,g,i,j,k,l,m,n,o,b=this;for(f=d(),e(),i='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="presentation" cellspacing="0"><tbody>',j=f.length-1,k=a.settings.textcolor_rows||5,l=a.settings.textcolor_cols||8,n=0;k>n;n++){for(i+="<tr>",m=0;l>m;m++)o=n*l+m,o>j?i+="<td></td>":(g=f[o],i+='<td class="mce-grid-cell"><div id="'+b._id+"-"+o+'"'+' data-mce-color="'+g.color+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(g?"background-color: #"+g.color:"")+'"'+' title="'+g.text+'">'+"</div>"+"</td>");i+="</tr>"}i+="</tbody></table>",0!=c.length&&(i+='<div id="mce-recent-pick-colors">',i+=h(),i+="</div>");var p="\u66f4\u591a\u984f\u8272";return i+='<div class="mce-menu-item"><button id="advtextcolor-showmorecolor" data-action="advtextcolor-popup" style="margin:0 auto;cursor:pointer;width:100%;text-align:center;" type="button">'+p+"</button>"+"</div>"}function h(){var a="",b=c;b.reverse(),a+='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="presentation" cellspacing="0"><tbody>';for(var d=0;2>d;d++){a+="<tr>";for(var e=0;8>e;e++){var f;f=e<b.length?b[e+8*d]:"ffffff",a+='<td><div data-mce-color="'+f+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(f?"background-color: #"+f:"")+'"'+' title="'+f+'">'+"</div>"+"</td>"}a+="</tr>"}return a+="</tbody></table>"}function i(a){var b=this.parent();a.target.getAttribute("data-mce-color")?j(a,b):"advtextcolor-popup"==a.target.getAttribute("data-action")&&k(a,b)}function j(b,c){var d;(d=b.target.getAttribute("data-mce-color"))&&(c.hidePanel(),d="#"+d,c.color(d),a.execCommand(c.settings.selectcmd,!1,d))}function k(c,d){d.hidePanel();var e,g;g=function(){var c=$(".mce-container-body>iframe")[0],g=c.contentDocument.getElementById("color").value;f(g),d.color(g),a.execCommand(d.settings.selectcmd,!1,g);var i=document.getElementById("mce-recent-pick-colors");null!==i&&(i.innerHTML="",i.innerHTML=h()),e.close()},e=a.windowManager.open({title:"\u8272\u76e4",url:b+"/colorpicker.html",width:280,height:320,buttons:[{text:"Ok",subtype:"primary",onclick:g},{text:"Cancel",onclick:"close"}]})}function l(){var b=this;b._color&&a.execCommand(b.settings.selectcmd,!1,b._color)}var c=[];a.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",selectcmd:"ForeColor",panel:{html:g,onclick:i},onclick:l}),a.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",selectcmd:"HiliteColor",panel:{html:g,onclick:i},onclick:l})});
