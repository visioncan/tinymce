tinymce.PluginManager.add("advtextcolor",function(e,t){var o=[];function r(){var t,o=[],r;r=e.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Brown","C0C0C0","Silver","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum","FFFFFF","White"];for(t=0;t<r.length;t+=2){o.push({text:r[t+1],color:r[t]})}return o}function l(){if(window.localStorage&&window.localStorage.getItem("color")){o=JSON.parse(window.localStorage["color"])}}function c(e){var t=[];o.push(e.replace("#",""));if(o.length>16){t=o.slice(-16)}else{t=o}if(window.localStorage){window.localStorage["color"]=JSON.stringify(t)}}function n(){var t=this,c,n,i,d,s,u,g,F,m;c=r();l();i='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="presentation" cellspacing="0"><tbody>';d=c.length-1;s=e.settings.textcolor_rows||5;u=e.settings.textcolor_cols||8;for(F=0;F<s;F++){i+="<tr>";for(g=0;g<u;g++){m=F*u+g;if(m>d){i+="<td></td>"}else{n=c[m];i+="<td>"+'<div id="'+t._id+"-"+m+'"'+' data-mce-color="'+n.color+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(n?"background-color: #"+n.color:"")+'"'+' title="'+n.text+'">'+"</div>"+"</td>"}}i+="</tr>"}i+="</tbody></table>";if(o.length!=0){i+='<div id="mce-recent-pick-colors">';i+=a();i+="</div>"}var f="更多顏色";i+='<div class="mce-menu-item">'+'<button id="advtextcolor-showmorecolor" data-action="advtextcolor-popup" style="margin:0 auto;cursor:pointer;width:100%;text-align:center;" type="button">'+f+"</button>"+"</div>";return i}function a(){var e="",t=o;t.reverse();e+='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="presentation" cellspacing="0"><tbody>';for(var r=0;r<2;r++){e+="<tr>";for(var l=0;l<8;l++){var c;if(l<t.length){c=t[l+r*8]}else{c="ffffff"}e+="<td>"+"<div"+' data-mce-color="'+c+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(c?"background-color: #"+c:"")+'"'+' title="'+c+'">'+"</div>"+"</td>"}e+="</tr>"}e+="</tbody></table>";return e}function i(e){var t=this.parent();if(e.target.getAttribute("data-mce-color")){d(e,t)}else if(e.target.getAttribute("data-action")=="advtextcolor-popup"){s(e,t)}}function d(t,o){var r;if(r=t.target.getAttribute("data-mce-color")){o.hidePanel();r="#"+r;o.color(r);e.execCommand(o.settings.selectcmd,false,r)}}function s(o,r){r.hidePanel();var l,n;n=function(t){var o=$(".mce-container-body>iframe")[0];var n=o.contentDocument.getElementById("color").value;c(n);r.color(n);e.execCommand(r.settings.selectcmd,false,n);var i=document.getElementById("mce-recent-pick-colors");if(i!==null){i.innerHTML="";i.innerHTML=a()}l.close()};l=e.windowManager.open({title:"色盤",url:t+"/colorpicker.html",width:280,height:320,buttons:[{text:"Ok",subtype:"primary",onclick:n},{text:"Cancel",onclick:"close"}]})}function u(){var t=this;if(t._color){e.execCommand(t.settings.selectcmd,false,t._color)}}e.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",selectcmd:"ForeColor",panel:{html:n,onclick:i},onclick:u});e.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",selectcmd:"HiliteColor",panel:{html:n,onclick:i},onclick:u})});